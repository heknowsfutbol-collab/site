<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>FootballTalk</title>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyB2eReZssn4F99io5eXDCjp-5zXD9utvEo",
  authDomain: "footballdiscussion-11812.firebaseapp.com",
  projectId: "footballdiscussion-11812",
  storageBucket: "footballdiscussion-11812.firebasestorage.app",
  messagingSenderId: "945766912077",
  appId: "1:945766912077:web:e8cbcf594331c1d4ea8c04",
  measurementId: "G-Y5QSXG60BP"
};

firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.firestore();
</script>

<style>
body {
  margin: 0;
  font-family: Arial, sans-serif;
  background: #0f172a;
  color: white;
}
header {
  background: #1e293b;
  padding: 15px;
  text-align: center;
  font-size: 22px;
  font-weight: bold;
}
.container {
  max-width: 800px;
  margin: auto;
  padding: 15px;
}
.box {
  background: #1e293b;
  padding: 15px;
  border-radius: 10px;
  margin-bottom: 15px;
}
input, textarea, select, button {
  width: 100%;
  padding: 10px;
  margin-top: 8px;
  border-radius: 6px;
  border: none;
}
button {
  background: #2563eb;
  color: white;
  font-weight: bold;
  cursor: pointer;
}
.room {
  background: #1e293b;
  padding: 15px;
  border-radius: 10px;
  margin-bottom: 15px;
}
.comment {
  background: #334155;
  padding: 6px;
  border-radius: 6px;
  margin-top: 4px;
  font-size: 14px;
}
.actions span {
  margin-right: 12px;
  cursor: pointer;
}
</style>
</head>

<body>
<header>‚öΩ FootballTalk</header>

<div class="container">

<div id="authBox" class="box">
<h3>Login / Signup</h3>
<input id="email" placeholder="Email">
<input id="password" type="password" placeholder="Password">
<button onclick="signup()">Sign Up</button>
<button onclick="login()">Login</button>
</div>

<div id="app" style="display:none">

<div class="box">
<h3>Create Discussion Room</h3>
<input id="title" placeholder="Room title">
<select id="category">
<option>Footballer</option>
<option>Team</option>
<option>Competition</option>
<option>Award</option>
<option>Controversy</option>
</select>
<textarea id="description" placeholder="Discussion text"></textarea>
<button onclick="createRoom()">Post</button>
<button onclick="logout()">Logout</button>
</div>

<div id="rooms"></div>

</div>

</div>

<script>
auth.onAuthStateChanged(user=>{
  if(user){
    document.getElementById("authBox").style.display="none";
    document.getElementById("app").style.display="block";
    loadRooms();
  } else {
    document.getElementById("authBox").style.display="block";
    document.getElementById("app").style.display="none";
  }
});

function signup(){
  auth.createUserWithEmailAndPassword(
    email.value, password.value
  ).catch(e=>alert(e.message));
}

function login(){
  auth.signInWithEmailAndPassword(
    email.value, password.value
  ).catch(e=>alert(e.message));
}

function logout(){
  auth.signOut();
}

function createRoom(){
  db.collection("rooms").add({
    title: title.value,
    category: category.value,
    description: description.value,
    likes: 0,
    dislikes: 0,
    comments: []
  });
  title.value="";
  description.value="";
}

function likeRoom(id, likes){
  db.collection("rooms").doc(id).update({
    likes: likes + 1
  });
}

function dislikeRoom(id, dislikes){
  db.collection("rooms").doc(id).update({
    dislikes: dislikes + 1
  });
}

function addComment(id){
  let input = document.getElementById("c"+id);
  if(!input.value) return;
  db.collection("rooms").doc(id).update({
    comments: firebase.firestore.FieldValue.arrayUnion(input.value)
  });
  input.value="";
}

function loadRooms(){
  db.collection("rooms").onSnapshot(snapshot=>{
    let html="";
    snapshot.forEach(doc=>{
      let r = doc.data();
      html += `
      <div class="room">
        <h3>${r.title}</h3>
        <small>${r.category}</small>
        <p>${r.description}</p>

        <div class="actions">
          <span onclick="likeRoom('${doc.id}', ${r.likes})">üëç ${r.likes}</span>
          <span onclick="dislikeRoom('${doc.id}', ${r.dislikes})">üëé ${r.dislikes}</span>
        </div>

        <input id="c${doc.id}" placeholder="Write comment">
        <button onclick="addComment('${doc.id}')">Comment</button>
        ${(r.comments||[]).map(c=>`<div class="comment">${c}</div>`).join("")}
      </div>
      `;
    });
    document.getElementById("rooms").innerHTML = html;
  });
}
</script>

</body>
</html>
